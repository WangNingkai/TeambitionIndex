import{r as i,c as s,w as e,o as d,a as t,b as a,F as l,d as o,u as m,e as n,t as u,f as r,g as c,h as p,i as h,j as f,k as v,l as g}from"./index.e068c056.js";import{_ as y,i as k,f as w,a as x,d as b}from"./utils.c240cc77.js";const I={class:"mdui-row mdui-shadow-3 mdui-p-a-1 mdui-m-y-3",style:{"border-radius":"8px"}},_={class:"mdui-list"},C=r('<li class="mdui-list-item mdui-ripple"><div class="mdui-row mdui-col-xs-12"><div class="mdui-col-xs-12 mdui-col-sm-7">文件</div><div class="mdui-col-sm-3 mdui-hidden-sm-down mdui-text-right">修改时间</div><div class="mdui-col-sm-2 mdui-hidden-sm-down mdui-text-right">大小</div></div></li>',1),R=a("div",{class:"mdui-col-sm-12"},[a("a",{href:"javascript:void(0);"},[a("i",{class:"mdui-icon material-icons"},"arrow_back"),c(" 返回上级 ")])],-1),M={key:1,class:"mdui-list-item mdui-ripple"},j=a("div",{class:"mdui-col-sm-12"},[a("i",{class:"mdui-icon material-icons"},"info"),c(" 没有更多数据呦")],-1),F={class:"mdui-row mdui-col-sm-12"},q={class:"mdui-col-xs-12 mdui-col-sm-7 mdui-text-truncate"},E={key:0,"data-name":"{{ node.name }}",href:"javascript:void(0);","aria-label":"Folder"},D=a("i",{class:"mdui-icon material-icons"},"folder_open",-1),$={key:1,"data-name":"{{ node.name }}",href:"javascript:void(0);","aria-label":"File"},H=a("i",{class:"mdui-icon material-icons"}," insert_drive_file ",-1),S={class:"mdui-col-sm-3 mdui-hidden-sm-down mdui-text-right"},z={class:"mdui-col-sm-2 mdui-hidden-sm-down mdui-text-right"},P=a("i",{class:"mdui-icon material-icons"},"file_download",-1),U={class:"mdui-list-item mdui-ripple"},Y={class:"mdui-col-sm-12 mdui-typo-body-1-opacity"},A={expose:[],setup(r){Date.prototype.Format=function(i){let s={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(i)&&(i=i.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(let e in s)new RegExp("("+e+")").test(i)&&(i=i.replace(RegExp.$1,1==RegExp.$1.length?s[e]:("00"+s[e]).substr((""+s[e]).length)));return i};const c=p(),A=h(),B=f(),G=i({parentId:"",list:[],item:{},limit:100,offset:0,totalCount:0,isRoot:1,loading:!1}),J=s((()=>b(B.query.nodeId,""))),K=s((()=>c.state.user)),L=async()=>{G.loading=!0,await w({_id:K._id,nodeId:J.value,offset:G.offset,limit:G.limit}).then((i=>{G.loading=!1;const s=i.result;G.limit=s.limit,G.offset=s.offset,G.totalCount=s.totalCount,G.list=s.list,G.item=s.item,G.nodeId=s.item.nodeId,G.parentId=s.item.parentId,G.isRoot=s.isRoot}))},N=(i,s="folder")=>{if(G.loading)return!1;"file"===s?A.push({name:"Preview",query:{nodeId:i}}):A.push({name:"Home",query:{nodeId:i}})};return e((()=>B.query.nodeId),(async i=>{await L()})),d((()=>{L()})),(i,s)=>(v(),t("div",I,[a("ul",_,[C,G.loading?(v(),t(y,{key:0,color:"mdui-color-blue-200"})):(v(),t(l,{key:1},[G.isRoot?o("v-if",!0):(v(),t("li",{key:0,class:"mdui-list-item mdui-ripple",onClick:s[1]||(s[1]=i=>N(G.parentId))},[R])),m(k)(G.list)?(v(),t("li",M,[j])):(v(!0),t(l,{key:2},n(G.list,(i=>(v(),t("li",{key:i.id,class:"mdui-list-item mdui-ripple",onClick:s=>N(i.nodeId,i.kind)},[a("div",F,[a("div",q,["folder"===i.kind?(v(),t("a",E,[D,a("span",null," "+u(i.name),1)])):(v(),t("a",$,[H,a("span",null," "+u(i.name),1)]))]),a("div",S,u(new Date(i.updated).Format("yyyy-MM-dd hh:mm:ss")),1),a("div",z,u("folder"===i.kind?"-":m(x)(i.size)),1)]),"file"===i.kind?(v(),t("a",{key:0,class:"mdui-btn mdui-ripple mdui-btn-icon mdui-hidden-sm-down download","aria-label":"Download",onClick:g((s=>{return e=i.downloadUrl,void window.open(e,"_blank");var e}),["stop"]),target:"_blank"},[P],8,["onClick"])):o("v-if",!0)],8,["onClick"])))),128)),a("li",U,[a("div",Y,u(G.totalCount)+" 个项目 ",1)])],64))])]))}};export default A;
